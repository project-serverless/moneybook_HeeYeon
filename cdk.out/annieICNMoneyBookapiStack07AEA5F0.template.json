{
 "Resources": {
  "MoneyBooklambdarole9E063379": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/AmazonS3FullAccess"
       ]
      ]
     },
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/AmazonDynamoDBFullAccess"
       ]
      ]
     }
    ],
    "RoleName": "annie-ICN-lambda-role"
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-lambda-role/Resource"
   }
  },
  "MoneyBookcreatefile084DA542": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-ap-northeast-2"
     },
     "S3Key": "ec0c827a07eb1b8d2e1ffa275b85b6009446f77b8af1e03214850debfef4b14d.zip"
    },
    "Environment": {
     "Variables": {
      "BUCKET_NAME": {
       "Fn::ImportValue": "annieICNMoneyBooks3Stack308186F5:ExportsOutputRefMoneyBookS3A8D67CA2322F994C"
      }
     }
    },
    "FunctionName": "annie-ICN-create-file",
    "Handler": "create_file.lambda_handler",
    "Role": {
     "Fn::GetAtt": [
      "MoneyBooklambdarole9E063379",
      "Arn"
     ]
    },
    "Runtime": "python3.10"
   },
   "DependsOn": [
    "MoneyBooklambdarole9E063379"
   ],
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-create-file/Resource",
    "aws:asset:path": "asset.ec0c827a07eb1b8d2e1ffa275b85b6009446f77b8af1e03214850debfef4b14d",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "MoneyBookaddmoneybookitem5D93FE7C": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": {
      "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-ap-northeast-2"
     },
     "S3Key": "12009fd70be4bc4d2b9186b2f9d448759cbc0b68aa309771e9209884d3ec5ea4.zip"
    },
    "Environment": {
     "Variables": {
      "TABLE_NAME": {
       "Fn::ImportValue": "annieICNMoneyBookdynamoStackC62E6D4F:ExportsOutputRefMoneyBookmoneybooktable3B4EAD9FDA63B39C"
      }
     }
    },
    "FunctionName": "annie-ICN-add-moneybook-item",
    "Handler": "index.lambda_handler",
    "Role": {
     "Fn::GetAtt": [
      "MoneyBooklambdarole9E063379",
      "Arn"
     ]
    },
    "Runtime": "python3.10"
   },
   "DependsOn": [
    "MoneyBooklambdarole9E063379"
   ],
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-add-moneybook-item/Resource",
    "aws:asset:path": "asset.12009fd70be4bc4d2b9186b2f9d448759cbc0b68aa309771e9209884d3ec5ea4",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "annieICNapiloggroup541CA09D": {
   "Type": "AWS::Logs::LogGroup",
   "Properties": {
    "LogGroupName": "/API-Gateway/annie-ICN-moneybook-api",
    "RetentionInDays": 731
   },
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/annie-ICN-api-log-group/Resource"
   }
  },
  "MoneyBookapiCA32F9A0": {
   "Type": "AWS::ApiGateway::RestApi",
   "Properties": {
    "Description": "Moneybook Application API",
    "EndpointConfiguration": {
     "Types": [
      "REGIONAL"
     ]
    },
    "Name": "annie-ICN-moneybook-api"
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/Resource"
   }
  },
  "MoneyBookapiCloudWatchRole23E60905": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "apigateway.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"
       ]
      ]
     }
    ]
   },
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/CloudWatchRole/Resource"
   }
  },
  "MoneyBookapiAccount467D18C4": {
   "Type": "AWS::ApiGateway::Account",
   "Properties": {
    "CloudWatchRoleArn": {
     "Fn::GetAtt": [
      "MoneyBookapiCloudWatchRole23E60905",
      "Arn"
     ]
    }
   },
   "DependsOn": [
    "MoneyBookapiCA32F9A0"
   ],
   "UpdateReplacePolicy": "Retain",
   "DeletionPolicy": "Retain",
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/Account"
   }
  },
  "MoneyBookapiDeployment67B46E97929dedbde5b55c4bdb854df4c12b8c1f": {
   "Type": "AWS::ApiGateway::Deployment",
   "Properties": {
    "Description": "Moneybook Application API",
    "RestApiId": {
     "Ref": "MoneyBookapiCA32F9A0"
    }
   },
   "DependsOn": [
    "MoneyBookapifilePOST59AE1376",
    "MoneyBookapifile8E1E661F",
    "MoneyBookapimoneybookPOST0EA2475D",
    "MoneyBookapimoneybook329A5C97"
   ],
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/Deployment/Resource"
   }
  },
  "MoneyBookapiDeploymentStagedev38883CE3": {
   "Type": "AWS::ApiGateway::Stage",
   "Properties": {
    "AccessLogSetting": {
     "DestinationArn": {
      "Fn::GetAtt": [
       "annieICNapiloggroup541CA09D",
       "Arn"
      ]
     },
     "Format": "$context.identity.sourceIp $context.identity.caller $context.identity.user [$context.requestTime] \"$context.httpMethod $context.resourcePath $context.protocol\" $context.status $context.responseLength $context.requestId"
    },
    "DeploymentId": {
     "Ref": "MoneyBookapiDeployment67B46E97929dedbde5b55c4bdb854df4c12b8c1f"
    },
    "MethodSettings": [
     {
      "DataTraceEnabled": false,
      "HttpMethod": "*",
      "LoggingLevel": "INFO",
      "MetricsEnabled": true,
      "ResourcePath": "/*"
     }
    ],
    "RestApiId": {
     "Ref": "MoneyBookapiCA32F9A0"
    },
    "StageName": "dev"
   },
   "DependsOn": [
    "MoneyBookapiAccount467D18C4"
   ],
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/DeploymentStage.dev/Resource"
   }
  },
  "MoneyBookapifile8E1E661F": {
   "Type": "AWS::ApiGateway::Resource",
   "Properties": {
    "ParentId": {
     "Fn::GetAtt": [
      "MoneyBookapiCA32F9A0",
      "RootResourceId"
     ]
    },
    "PathPart": "file",
    "RestApiId": {
     "Ref": "MoneyBookapiCA32F9A0"
    }
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/Default/file/Resource"
   }
  },
  "MoneyBookapifilePOSTApiPermissionannieICNMoneyBookapiStackMoneyBookapi3188CDF4POSTfileCF53042A": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "MoneyBookcreatefile084DA542",
      "Arn"
     ]
    },
    "Principal": "apigateway.amazonaws.com",
    "SourceArn": {
     "Fn::Join": [
      "",
      [
       "arn:aws:execute-api:ap-northeast-2:",
       {
        "Ref": "AWS::AccountId"
       },
       ":",
       {
        "Ref": "MoneyBookapiCA32F9A0"
       },
       "/",
       {
        "Ref": "MoneyBookapiDeploymentStagedev38883CE3"
       },
       "/POST/file"
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/Default/file/POST/ApiPermission.annieICNMoneyBookapiStackMoneyBookapi3188CDF4.POST..file"
   }
  },
  "MoneyBookapifilePOSTApiPermissionTestannieICNMoneyBookapiStackMoneyBookapi3188CDF4POSTfile2B6A1949": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "MoneyBookcreatefile084DA542",
      "Arn"
     ]
    },
    "Principal": "apigateway.amazonaws.com",
    "SourceArn": {
     "Fn::Join": [
      "",
      [
       "arn:aws:execute-api:ap-northeast-2:",
       {
        "Ref": "AWS::AccountId"
       },
       ":",
       {
        "Ref": "MoneyBookapiCA32F9A0"
       },
       "/test-invoke-stage/POST/file"
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/Default/file/POST/ApiPermission.Test.annieICNMoneyBookapiStackMoneyBookapi3188CDF4.POST..file"
   }
  },
  "MoneyBookapifilePOST59AE1376": {
   "Type": "AWS::ApiGateway::Method",
   "Properties": {
    "ApiKeyRequired": true,
    "AuthorizationType": "NONE",
    "HttpMethod": "POST",
    "Integration": {
     "IntegrationHttpMethod": "POST",
     "Type": "AWS_PROXY",
     "Uri": {
      "Fn::Join": [
       "",
       [
        "arn:aws:apigateway:ap-northeast-2:lambda:path/2015-03-31/functions/",
        {
         "Fn::GetAtt": [
          "MoneyBookcreatefile084DA542",
          "Arn"
         ]
        },
        "/invocations"
       ]
      ]
     }
    },
    "ResourceId": {
     "Ref": "MoneyBookapifile8E1E661F"
    },
    "RestApiId": {
     "Ref": "MoneyBookapiCA32F9A0"
    }
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/Default/file/POST/Resource"
   }
  },
  "MoneyBookapimoneybook329A5C97": {
   "Type": "AWS::ApiGateway::Resource",
   "Properties": {
    "ParentId": {
     "Fn::GetAtt": [
      "MoneyBookapiCA32F9A0",
      "RootResourceId"
     ]
    },
    "PathPart": "moneybook",
    "RestApiId": {
     "Ref": "MoneyBookapiCA32F9A0"
    }
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/Default/moneybook/Resource"
   }
  },
  "MoneyBookapimoneybookPOSTApiPermissionannieICNMoneyBookapiStackMoneyBookapi3188CDF4POSTmoneybook633E14DA": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "MoneyBookaddmoneybookitem5D93FE7C",
      "Arn"
     ]
    },
    "Principal": "apigateway.amazonaws.com",
    "SourceArn": {
     "Fn::Join": [
      "",
      [
       "arn:aws:execute-api:ap-northeast-2:",
       {
        "Ref": "AWS::AccountId"
       },
       ":",
       {
        "Ref": "MoneyBookapiCA32F9A0"
       },
       "/",
       {
        "Ref": "MoneyBookapiDeploymentStagedev38883CE3"
       },
       "/POST/moneybook"
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/Default/moneybook/POST/ApiPermission.annieICNMoneyBookapiStackMoneyBookapi3188CDF4.POST..moneybook"
   }
  },
  "MoneyBookapimoneybookPOSTApiPermissionTestannieICNMoneyBookapiStackMoneyBookapi3188CDF4POSTmoneybook78E4A24C": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "MoneyBookaddmoneybookitem5D93FE7C",
      "Arn"
     ]
    },
    "Principal": "apigateway.amazonaws.com",
    "SourceArn": {
     "Fn::Join": [
      "",
      [
       "arn:aws:execute-api:ap-northeast-2:",
       {
        "Ref": "AWS::AccountId"
       },
       ":",
       {
        "Ref": "MoneyBookapiCA32F9A0"
       },
       "/test-invoke-stage/POST/moneybook"
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/Default/moneybook/POST/ApiPermission.Test.annieICNMoneyBookapiStackMoneyBookapi3188CDF4.POST..moneybook"
   }
  },
  "MoneyBookapimoneybookPOST0EA2475D": {
   "Type": "AWS::ApiGateway::Method",
   "Properties": {
    "ApiKeyRequired": true,
    "AuthorizationType": "NONE",
    "HttpMethod": "POST",
    "Integration": {
     "IntegrationHttpMethod": "POST",
     "Type": "AWS_PROXY",
     "Uri": {
      "Fn::Join": [
       "",
       [
        "arn:aws:apigateway:ap-northeast-2:lambda:path/2015-03-31/functions/",
        {
         "Fn::GetAtt": [
          "MoneyBookaddmoneybookitem5D93FE7C",
          "Arn"
         ]
        },
        "/invocations"
       ]
      ]
     }
    },
    "ResourceId": {
     "Ref": "MoneyBookapimoneybook329A5C97"
    },
    "RestApiId": {
     "Ref": "MoneyBookapiCA32F9A0"
    }
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/Default/moneybook/POST/Resource"
   }
  },
  "MoneyBookapiMoneyBookApiKey8B608952": {
   "Type": "AWS::ApiGateway::ApiKey",
   "Properties": {
    "Description": "Moneybook API Key",
    "Enabled": true,
    "Name": "annie-ICN-ApiKey",
    "StageKeys": [
     {
      "RestApiId": {
       "Ref": "MoneyBookapiCA32F9A0"
      },
      "StageName": {
       "Ref": "MoneyBookapiDeploymentStagedev38883CE3"
      }
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/MoneyBook-ApiKey/Resource"
   }
  },
  "MoneyBookapiMoneyBookUsagePlan971D4789": {
   "Type": "AWS::ApiGateway::UsagePlan",
   "Properties": {
    "ApiStages": [
     {
      "ApiId": {
       "Ref": "MoneyBookapiCA32F9A0"
      },
      "Stage": {
       "Ref": "MoneyBookapiDeploymentStagedev38883CE3"
      },
      "Throttle": {}
     }
    ],
    "Description": "Moneybook Usage Plan",
    "UsagePlanName": "annie-ICN-UsagePlan"
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/MoneyBook-UsagePlan/Resource"
   }
  },
  "MoneyBookapiMoneyBookUsagePlanUsagePlanKeyResourceannieICNMoneyBookapiStackMoneyBookapiMoneyBookApiKey836D8D0EE6C35644": {
   "Type": "AWS::ApiGateway::UsagePlanKey",
   "Properties": {
    "KeyId": {
     "Ref": "MoneyBookapiMoneyBookApiKey8B608952"
    },
    "KeyType": "API_KEY",
    "UsagePlanId": {
     "Ref": "MoneyBookapiMoneyBookUsagePlan971D4789"
    }
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/MoneyBook-api/MoneyBook-UsagePlan/UsagePlanKeyResource:annieICNMoneyBookapiStackMoneyBookapiMoneyBookApiKey836D8D0E"
   }
  },
  "CDKMetadata": {
   "Type": "AWS::CDK::Metadata",
   "Properties": {
    "Analytics": "v2:deflate64:H4sIAAAAAAAA/21Qy07DMBD8lt4d94GE4EZaBAdAREWcK9dZUreObWVtqijyv7N2UrUHTjuz3t0Zz4o/rviwmIkzFrI+FVrt+fDlhTwxau0GJVo+bK0GtvkxqUaGdzuBCB55mQpxvg7yBH4tEJgW7b4WfKDxl2CkV9ak1Qq6ViESi0zbBvnwbpvXzgaXXi84MuFUIzycRU+ygL50KitfYSmlDcazZ3Da9i0QpO4NI/dNtjsCWrWhk5DdXch0c8Qf4A+2Tq0JkdIb9FlsRN9Ilyot8lf+JzQW4/V+jiYZUKZJc5/Bu+BvZSNbFEK7g+CL2dMU/zzVMcHC9eTFTCNVJpdAIzO2Bn7E+e/ygS/v6cIRlSo6ykW1wLdj/QOkb5To3AEAAA=="
   },
   "Metadata": {
    "aws:cdk:path": "annie-ICN/MoneyBook-apiStack/CDKMetadata/Default"
   }
  }
 },
 "Outputs": {
  "MoneyBookapiEndpoint1EB86263": {
   "Value": {
    "Fn::Join": [
     "",
     [
      "https://",
      {
       "Ref": "MoneyBookapiCA32F9A0"
      },
      ".execute-api.ap-northeast-2.",
      {
       "Ref": "AWS::URLSuffix"
      },
      "/",
      {
       "Ref": "MoneyBookapiDeploymentStagedev38883CE3"
      },
      "/"
     ]
    ]
   }
  }
 },
 "Parameters": {
  "BootstrapVersion": {
   "Type": "AWS::SSM::Parameter::Value<String>",
   "Default": "/cdk-bootstrap/hnb659fds/version",
   "Description": "Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]"
  }
 },
 "Rules": {
  "CheckBootstrapVersion": {
   "Assertions": [
    {
     "Assert": {
      "Fn::Not": [
       {
        "Fn::Contains": [
         [
          "1",
          "2",
          "3",
          "4",
          "5"
         ],
         {
          "Ref": "BootstrapVersion"
         }
        ]
       }
      ]
     },
     "AssertDescription": "CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI."
    }
   ]
  }
 }
}